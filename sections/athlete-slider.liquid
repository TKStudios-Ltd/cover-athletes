{% comment %} Athlete Slider — JS in assets/athlete-slider.js {% endcomment %}

{{ 'component-image-with-text.css' | asset_url | stylesheet_tag }}

{%- style -%}
/* ===== Shell ===== */
.athlete-{{ section.id }} { position: relative; width: calc(100vw - 11px) !important; }
.athlete-{{ section.id }} .slider-shell {
  position: relative; overflow: hidden;
  isolation: isolate;
}

/* ===== Background Swiper ===== */
.athlete-{{ section.id }} .bg-swiper,
.athlete-{{ section.id }} .bg-swiper .swiper-wrapper,
.athlete-{{ section.id }} .bg-swiper .swiper-slide { width: 100%; height: 100%; }
.athlete-{{ section.id }} .bg-swiper { position: absolute; inset: 0; z-index: 1; }
.athlete-{{ section.id }} .bg-media { position: absolute; inset: 0; }
.athlete-{{ section.id }} .bg-media img,
.athlete-{{ section.id }} .bg-media video {
  position: absolute; inset: 0;
  width: 100%; height: 100%; object-fit: cover; display:block;
  transform: scale(1); transition: transform 1.2s ease;
}
.athlete-{{ section.id }} .kenburns .bg-media img,
.athlete-{{ section.id }} .kenburns .bg-media video { animation: kb-{{ section.id }} 10s ease forwards; }
@keyframes kb-{{ section.id }} { 0% { transform: scale(1); } 100% { transform: scale(1.06); } }

/* ===== Overlay for contrast ===== */
.athlete-{{ section.id }} .overlay {
  position: absolute; inset: 0; z-index: 2;
  background: linear-gradient(90deg, rgba(0,0,0,.65) 0%, rgba(0,0,0,.35) 40%, rgba(0,0,0,.15) 64%, rgba(0,0,0,0) 100%);
  pointer-events: none;
}

/* ===== Foreground content (flex, left stack) ===== */
.athlete-{{ section.id }} .content {
  position: relative; z-index: 3; color: #fff;
  display: flex; flex-direction: column; align-items: flex-start; gap: 16px;
  min-height: clamp(420px, 62vw, 720px);
  padding: clamp(20px, 4vw, 40px);
  max-width: 980px;
}

.athlete-{{ section.id }} .left-top { display:flex; align-items:center; gap:12px; opacity:.95; }
.athlete-{{ section.id }} .left-top img { height: 22px; width:auto; }
.athlete-{{ section.id }} .eyebrow { font-size: 14px; letter-spacing:.4px; opacity:.9; }

.athlete-{{ section.id }} .title {
  margin: 8px 0 0 0;
  font-size: clamp(28px, 4.5vw, 54px);
  line-height: .95;
  text-transform: uppercase;
}

/* ===== Arrows (above copy) ===== */
.athlete-{{ section.id }} .nav { display:flex; gap:10px; margin-top: 6px; position: relative; z-index: 5; }
.athlete-{{ section.id }} .nav .btn {
  width: 34px; height: 34px; display:grid; place-items:center; border-radius:999px;
  background: rgba(255,255,255,.12);
  border: 1px solid rgba(255,255,255,.18);
  transition: background .2s ease, transform .2s ease;
  cursor: pointer; backdrop-filter: blur(8px);
}
.athlete-{{ section.id }} .nav .btn:hover { background: rgba(255,255,255,.2); transform: translateY(-1px); }
.athlete-{{ section.id }} .nav svg { width: 14px; height: 14px; }

/* ===== Copy items container (fixed position, stable height) ===== */
.athlete-{{ section.id }} .copy-items {
  position: relative; width: 100%; z-index: 4;
  min-height: var(--copy-h, 0px);
}
.athlete-{{ section.id }} .copy-items .item {
  position: absolute; inset: 0;
  opacity: 0; pointer-events: none;
}
.athlete-{{ section.id }} .copy-items .item.is-active {
  opacity: 1; pointer-events: auto;
}

/* ===== Text motion (slide up) ===== */
.athlete-{{ section.id }} .slide-content { max-width: 760px; }
.athlete-{{ section.id }} .quote, .athlete-{{ section.id }} .person { opacity: 0; transform: translateY(10px); }
.athlete-{{ section.id }} .copy-items .item.is-active .quote { animation: copyIn-{{ section.id }} .45s ease forwards; }
.athlete-{{ section.id }} .copy-items .item.is-active .person { animation: copyIn-{{ section.id }} .45s ease .14s forwards; }
@keyframes copyIn-{{ section.id }} { from { opacity:0; transform: translateY(10px); } to { opacity:1; transform: translateY(0); } }

.athlete-{{ section.id }} .quote { font-size: clamp(14px, 1.3vw, 18px); line-height: 1.55; opacity:.98; }
.athlete-{{ section.id }} .person { margin-top: 12px; font-size: 14px; opacity:.9; }

/* Full width inside section wrappers */
.section .athlete-{{ section.id }} { width: 100%; }
{%- endstyle -%}

<section
  class="athlete-{{ section.id }} color-{{ section.settings.color_scheme }}"
  data-component="athlete-slider"
  data-section-id="{{ section.id }}"
>
  <div
    class="slider-shell{% if section.settings.ken_burns %} kenburns{% endif %}"
    data-effect="{{ section.settings.effect }}"
    data-autoplay="{{ section.settings.autoplay }}"
    data-delay="{{ section.settings.delay | times: 1000 }}"
    data-loop="{{ section.settings.loop }}"
  >

    <!-- Background Swiper -->
    <div id="AthleteBg-{{ section.id }}" class="swiper bg-swiper">
      <div class="swiper-wrapper">
        {% for block in section.blocks %}
          {% if block.type == 'slide' %}
            <div class="swiper-slide" {{ block.shopify_attributes }}>
              <div class="bg-media">
                {% if block.settings.video != blank %}
                  {{ block.settings.video | video_tag: autoplay: true, loop: true, muted: true, playsinline: true }}
                {% elsif block.settings.image != blank %}
                  {% assign widths = '1200, 1600, 2000, 2400, 3000' %}
                  {% capture sizes %}100vw{% endcapture %}
                  {{ block.settings.image | image_url: width: 3000 | image_tag: widths: widths, sizes: sizes, loading: 'lazy' }}
                {% else %}
                  {{ 'lifestyle-2' | placeholder_svg_tag: 'placeholder-svg' }}
                {% endif %}
              </div>
            </div>
          {% endif %}
        {% endfor %}
      </div>
      {# bullets intentionally removed #}
    </div>

    <!-- Overlay -->
    <div class="overlay"></div>

    <!-- Foreground content -->
    <div class="content">
      {% if section.settings.label_icon != blank or section.settings.eyebrow != blank %}
        <div class="left-top">
          {% if section.settings.label_icon != blank %}
            {{ section.settings.label_icon | image_url: width: 120 | image_tag: loading: 'lazy' }}
          {% endif %}
          {% if section.settings.eyebrow != blank %}
            <div class="eyebrow">{{ section.settings.eyebrow }}</div>
          {% endif %}
        </div>
      {% endif %}

      {% if section.settings.title != blank %}
        <h2 class="title inline-richtext {{ section.settings.title_size }}">{{ section.settings.title }}</h2>
      {% endif %}

      <!-- Arrows ABOVE copy -->
      <div class="nav">
        <button class="btn prev" aria-label="Previous">
          <svg viewBox="0 0 24 24" fill="none"><path d="M15 6l-6 6 6 6" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
        </button>
        <button class="btn next" aria-label="Next">
          <svg viewBox="0 0 24 24" fill="none"><path d="M9 18l6-6-6-6" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
        </button>
      </div>

      <!-- Copy items (simple list, first is active in HTML) -->
      <div id="AthleteCopy-{{ section.id }}" class="copy-items">
        {% for block in section.blocks %}
          {% if block.type == 'slide' %}
            <div class="item{% if forloop.first %} is-active{% endif %}" data-slide="{{ forloop.index0 }}">
              <div class="slide-content">
                {% if block.settings.quote != blank %}
                  <div class="quote rte">{{ block.settings.quote }}</div>
                {% endif %}
                {% if block.settings.person_name != blank or block.settings.person_title != blank %}
                  <div class="person">
                    {% if block.settings.person_name != blank %}
                      <strong>{{ block.settings.person_name }}</strong>{% if block.settings.person_title != blank %}<br>{% endif %}
                    {% endif %}
                    {% if block.settings.person_title != blank %}
                      <span>{{ block.settings.person_title }}</span>
                    {% endif %}
                  </div>
                {% endif %}
              </div>
            </div>
          {% endif %}
        {% endfor %}
      </div>
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Athlete Slider",
  "class": "section",
  "disabled_on": { "groups": ["header","footer"] },
  "settings": [
    { "type": "image_picker", "id": "label_icon", "label": "Small icon (left label)" },
    { "type": "text", "id": "eyebrow", "label": "Subtitle (left label)", "default": "Cover Athletes" },
    { "type": "inline_richtext", "id": "title", "label": "Title", "default": "Real Athletes Real Stories" },
    { "type": "select", "id": "title_size", "label": "Title size", "default": "h1", "options": [
      { "value": "h3", "label": "H3" }, { "value": "h2", "label": "H2" }, { "value": "h1", "label": "H1" }, { "value": "h0", "label": "H0" }
    ]},

    { "type": "checkbox", "id": "ken_burns", "label": "Subtle Ken Burns zoom", "default": true },
    { "type": "select", "id": "effect", "label": "Transition effect", "default": "slide", "options": [
      { "value": "slide", "label": "Slide" },
      { "value": "fade", "label": "Fade" }
    ]},
    { "type": "checkbox", "id": "autoplay", "label": "Autoplay", "default": true },
    { "type": "range", "id": "delay", "label": "Autoplay delay (sec)", "min": 3, "max": 15, "step": 1, "default": 6 },
    { "type": "checkbox", "id": "loop", "label": "Loop", "default": true },

    { "type": "color_scheme", "id": "color_scheme", "label": "Color scheme", "default": "scheme-1" }
  ],
  "blocks": [
    {
      "type": "slide",
      "name": "Slide",
      "settings": [
        { "type": "image_picker", "id": "image", "label": "Background image" },
        { "type": "video", "id": "video", "label": "Background video (optional)" },
        { "type": "richtext", "id": "quote", "label": "Quote/content", "default": "<p>I’ve faced 150kph bouncers and never thought twice because I trust what’s protecting me.</p>" },
        { "type": "text", "id": "person_name", "label": "Name", "default": "Kane Williamson" },
        { "type": "text", "id": "person_title", "label": "Role", "default": "NZ International Cricketer" }
      ]
    }
  ],
  "presets": [
    { "name": "Athlete Slider", "blocks": [{ "type": "slide" }, { "type": "slide" }, { "type": "slide" }] }
  ]
}
{% endschema %}
