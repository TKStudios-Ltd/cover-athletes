{% comment %} Athlete Slider — BG fades, left-stacked content, arrows above; JS in assets/athlete-slider.js {% endcomment %}

{{ 'component-image-with-text.css' | asset_url | stylesheet_tag }}

{%- style -%}
.athlete-{{ section.id }} { position: relative; width: calc(100vw - 11px) !important; }

.athlete-{{ section.id }} .wrap {
  position: relative;
  overflow: hidden;
  min-height: clamp(520px, 75vh, 860px);
  border-radius: 16px;
}

/* Background swiper fills the section */
.athlete-{{ section.id }} .bg-swiper,
.athlete-{{ section.id }} .bg-swiper .swiper-wrapper,
.athlete-{{ section.id }} .bg-swiper .swiper-slide {
  width: 100%; height: 100%;
}
.athlete-{{ section.id }} .bg-swiper .swiper-slide {
  position: relative;
}
.athlete-{{ section.id }} .bg-img {
  position: absolute; inset: 0;
  width: 100%; height: 100%;
  object-fit: cover; object-position: center;
}
.athlete-{{ section.id }} .bg-overlay {
  position: absolute; inset: 0;
  background: linear-gradient(90deg, rgba(0,0,0,.65) 0%, rgba(0,0,0,.25) 55%, rgba(0,0,0,.1) 100%);
  pointer-events: none;
}

/* Foreground content (fixed column at left) */
.athlete-{{ section.id }} .content {
  position: absolute; inset: 0;
  display: flex; flex-direction: column; align-items: flex-start; justify-content: flex-start;
  padding: clamp(20px, 4vw, 40px);
  gap: clamp(14px, 2vw, 24px);
  color: #fff;
}

/* Eyebrow row (icon + subtitle) */
.athlete-{{ section.id }} .eyebrow {
  display: inline-flex; gap: 10px; align-items: center;
  opacity: .9; font-size: 14px; line-height: 1;
}
.athlete-{{ section.id }} .eyebrow img { height: 16px; width: auto; }

/* Title block */
.athlete-{{ section.id }} .title {
  margin: 0; color: #fff;
}

/* Controls above content */
.athlete-{{ section.id }} .controls {
  display: flex; gap: 8px; align-items: center;
}
.athlete-{{ section.id }} .nav-btn {
  appearance: none; border: 0; border-radius: 999px;
  width: 36px; height: 36px; display: inline-flex; align-items: center; justify-content: center;
  background: rgba(255,255,255,.08);
  color: #fff; cursor: pointer;
  transition: background .2s ease, transform .2s ease;
}
.athlete-{{ section.id }} .nav-btn:hover { background: rgba(255,255,255,.18); transform: translateY(-1px); }
.athlete-{{ section.id }} .nav-btn svg { width: 16px; height: 16px; }

/* Text-swiper area (left column stack) */
.athlete-{{ section.id }} .text-area {
  display: flex; flex-direction: column; gap: 16px; max-width: min(640px, 90vw);
  margin-top: clamp(6px, 1.5vw, 12px);
}
.athlete-{{ section.id }} .text-swiper { width: 100%; }
.athlete-{{ section.id }} .text-swiper .swiper-slide { width: 100%; }
.athlete-{{ section.id }} .quote {
  font-size: clamp(16px, 1.85vw, 20px);
  line-height: 1.55;
}
.athlete-{{ section.id }} .meta {
  margin-top: 8px; opacity: .9; font-size: 14px;
}

/* Remove bullets entirely */
.athlete-{{ section.id }} .swiper-pagination { display: none !important; }
{%- endstyle -%}

{% liquid
  assign fetch_priority = section.index | default: 2
  if fetch_priority == 1
    assign fetch_priority = 'high'
  else
    assign fetch_priority = 'auto'
  endif
%}

<section
  class="athlete-{{ section.id }} color-{{ section.settings.color_scheme }}"
  data-component="athlete-slider"
  data-section-id="{{ section.id }}"
>
  <div class="wrap">

    {%- comment -%} BACKGROUND: fade-swiper (images) {%- endcomment -%}
    <div id="AthleteBG-{{ section.id }}" class="swiper bg-swiper"
         data-autoplay="{{ section.settings.autoplay }}"
         data-delay="{{ section.settings.autoplay_delay | times: 1000 }}"
         data-loop="{{ section.settings.loop }}">
      <div class="swiper-wrapper">
        {% for block in section.blocks %}
          {% if block.type == 'slide' %}
            <div class="swiper-slide" {{ block.shopify_attributes }}>
              {% if block.settings.bg_image != blank %}
                {{ block.settings.bg_image
                  | image_url: width: 2400
                  | image_tag: widths: '1200,1600,2000,2400', sizes: '100vw', fetchpriority: fetch_priority, class: 'bg-img' }}
              {% else %}
                {{ 'hero-apparel-1' | placeholder_svg_tag: 'bg-img' }}
              {% endif %}
              <span class="bg-overlay"></span>
            </div>
          {% endif %}
        {% endfor %}
      </div>
    </div>

    {%- comment -%} FOREGROUND: left column, fixed header + arrows + text-swiper {%- endcomment -%}
    <div class="content">
      {% if section.settings.eyebrow_text != blank or section.settings.eyebrow_icon != blank %}
        <div class="eyebrow">
          {% if section.settings.eyebrow_icon != blank %}
            {{ section.settings.eyebrow_icon | image_url: width: 40 | image_tag: loading: 'lazy' }}
          {% endif %}
          <span>{{ section.settings.eyebrow_text }}</span>
        </div>
      {% endif %}

      {% if section.settings.heading != blank %}
        <h2 class="title inline-richtext {{ section.settings.heading_size }}">{{ section.settings.heading }}</h2>
      {% endif %}

      <div class="controls">
        <button class="nav-btn prev" aria-label="Previous">
          <svg viewBox="0 0 24 24" fill="none"><path d="M15 5l-7 7 7 7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
        </button>
        <button class="nav-btn next" aria-label="Next">
          <svg viewBox="0 0 24 24" fill="none"><path d="M9 5l7 7-7 7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
        </button>
      </div>

      <div class="text-area">
        <div id="AthleteTXT-{{ section.id }}" class="swiper text-swiper">
          <div class="swiper-wrapper">
            {% for block in section.blocks %}
              {% if block.type == 'slide' %}
                <div class="swiper-slide">
                  {% if block.settings.kicker != blank %}
                    <div class="kicker" style="opacity:.85; margin-bottom:6px; font-size:13px;">{{ block.settings.kicker }}</div>
                  {% endif %}
                  {% if block.settings.quote != blank %}
                    <div class="quote rte">{{ block.settings.quote }}</div>
                  {% endif %}
                  {% if block.settings.person != blank or block.settings.role != blank %}
                    <div class="meta">
                      {% if block.settings.person != blank %}<strong>{{ block.settings.person }}</strong>{% endif %}
                      {% if block.settings.role != blank %}<div>{{ block.settings.role }}</div>{% endif %}
                    </div>
                  {% endif %}
                </div>
              {% endif %}
            {% endfor %}
          </div>
        </div>
      </div>

    </div>
  </div>
</section>

{% schema %}
{
  "name": "Athlete Slider",
  "class": "section",
  "disabled_on": { "groups": ["header", "footer"] },
  "settings": [
    { "type": "image_picker", "id": "eyebrow_icon", "label": "Eyebrow icon" },
    { "type": "text", "id": "eyebrow_text", "label": "Eyebrow text", "default": "Cover Athletes" },
    { "type": "inline_richtext", "id": "heading", "label": "Heading", "default": "Real Athletes Real Stories" },
    { "type": "select", "id": "heading_size", "label": "Heading size", "default": "h1",
      "options": [{ "value":"h3","label":"H3"},{ "value":"h2","label":"H2"},{ "value":"h1","label":"H1"},{ "value":"h0","label":"H0"}]
    },
    { "type": "checkbox", "id": "autoplay", "label": "Autoplay", "default": true },
    { "type": "range", "id": "autoplay_delay", "label": "Autoplay delay (seconds)", "min": 3, "max": 12, "step": 1, "default": 6 },
    { "type": "checkbox", "id": "loop", "label": "Loop slides", "default": true },
    { "type": "color_scheme", "id": "color_scheme", "label": "Color scheme", "default": "scheme-1" }
  ],
  "blocks": [
    {
      "type": "slide",
      "name": "Slide",
      "settings": [
        { "type": "image_picker", "id": "bg_image", "label": "Background image" },
        { "type": "text", "id": "kicker", "label": "Small label (optional)" },
        { "type": "richtext", "id": "quote", "label": "Quote", "default": "<p>I’ve faced 150kph bouncers and never thought twice—because I trust what’s protecting me.</p>" },
        { "type": "text", "id": "person", "label": "Name", "default": "Kane Williamson" },
        { "type": "text", "id": "role", "label": "Role", "default": "NZ International Cricketer" }
      ]
    }
  ],
  "presets": [
    { "name": "Athlete Slider", "blocks": [{ "type":"slide" }, { "type":"slide" }, { "type":"slide" }] }
  ]
}
{% endschema %}
