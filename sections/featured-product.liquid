<script type="application/ld+json">
  {{ section.settings.product | structured_data }}
</script>

<div class="section-background color-{{ section.settings.color_scheme }}"></div>
<div
  class="
    featured-product-section
    section
    section--full-width
    color-{{ section.settings.color_scheme }}
  "
>
  <div
    class="section-content-wrapper spacing-style size-style border-style"
    style="
      {% render 'spacing-style', settings: section.settings %}
      --media-height: 100%;
      {% if request.visual_preview_mode %}
        --visual-preview--height: 100%;
      {% endif %}
    "
  >
    {% assign featured_product = section.settings.product %}

    {% if featured_product != blank %}
      {% comment %}
        Decide column order based on layout setting
      {% endcomment %}
      {% if section.settings.layout == 'media-left' %}
        <div class="featured-product__media-column">
          {% for block in section.blocks %}
            {% if block.type == 'media' %}
              {% render 'featured-product-block', block: block, product: featured_product %}
            {% endif %}
          {% endfor %}
        </div>

        <div class="featured-product__content-column">
          {% for block in section.blocks %}
            {% unless block.type == 'media' %}
              {% render 'featured-product-block', block: block, product: featured_product %}
            {% endunless %}
          {% endfor %}
        </div>
      {% else %}
        <div class="featured-product__content-column">
          {% for block in section.blocks %}
            {% unless block.type == 'media' %}
              {% render 'featured-product-block', block: block, product: featured_product %}
            {% endunless %}
          {% endfor %}
        </div>

        <div class="featured-product__media-column">
          {% for block in section.blocks %}
            {% if block.type == 'media' %}
              {% render 'featured-product-block', block: block, product: featured_product %}
            {% endif %}
          {% endfor %}
        </div>
      {% endif %}
    {% else %}
      <div class="featured-product__empty">
        <p>{{ 'onboarding.product.title' | t }}</p>
      </div>
    {% endif %}
  </div>
</div>

{% stylesheet %}
  .featured-product-section .section-content-wrapper {
    grid-template-columns: 1fr;
    display: grid;
    overflow: hidden;
    gap: 2rem;

    @media (min-width: 750px) {
      grid-template-columns: 1fr 1fr;
      align-items: stretch;
    }
  }

  .featured-product__media-column {
    position: relative;
  }

  .featured-product__content-column {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .featured-product-section .product-media-container.constrain-height {
    --viewport-offset: 400px;
    --constrained-min-height: var(--visual-preview--height, 80dvh);

    @media screen and (min-width: 750px) {
      --viewport-offset: 300px;
    }
  }

  .featured-product-section .product-grid__card {
    --padding-block: 20px;
    --padding-inline: 20px;

    @media screen and (min-width: 750px) {
      --padding-block: 40px;
      --padding-inline: 40px;
    }
  }

  @media screen and (max-width: 749px) {
    .featured-product-section .media-block {
      order: -1;
    }
  }

  .featured-product__media-gallery {
    display: grid;
    gap: 0.75rem;
  }

  .featured-product__media-gallery-main img {
    width: 100%;
    height: auto;
    display: block;
  }

  .featured-product__media-thumbs {
    display: flex;
    gap: 0.5rem;
    margin-top: 0.5rem;
    overflow-x: auto;
  }

  .featured-product__media-thumb img {
    display: block;
    width: 70px;
    height: auto;
  }

  .featured-product__price {
    font-size: 1.1rem;
    font-weight: 500;
  }

  .featured-product__block {
    margin-bottom: 0.5rem;
  }

  .featured-product__form {
    display: grid;
    gap: 0.75rem;
  }

  .featured-product__variant-select {
    width: 100%;
  }

  .featured-product__buttons {
    display: flex;
    flex-wrap: wrap;
    gap: 0.75rem;
  }
{% endstylesheet %}

{% schema %}
{
  "name": "Featured product",
  "disabled_on": {
    "groups": ["header"]
  },
  "settings": [
    {
      "type": "product",
      "id": "product",
      "label": "Product"
    },
    {
      "type": "select",
      "id": "layout",
      "label": "Media position",
      "options": [
        { "value": "media-left", "label": "Left" },
        { "value": "media-right", "label": "Right" }
      ],
      "default": "media-left"
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color scheme",
      "default": "scheme-1"
    },
    {
      "type": "header",
      "content": "Padding"
    },
    {
      "type": "range",
      "id": "padding-block-start",
      "label": "Top",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "padding-block-end",
      "label": "Bottom",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 0
    }
  ],

  "blocks": [
    {
      "type": "media",
      "name": "Product media",
      "limit": 1,
      "settings": []
    },
    {
      "type": "title",
      "name": "Title",
      "settings": [
        {
          "type": "select",
          "id": "heading_tag",
          "label": "Heading size",
          "options": [
            { "value": "h2", "label": "H2" },
            { "value": "h3", "label": "H3" },
            { "value": "h4", "label": "H4" },
            { "value": "h5", "label": "H5" }
          ],
          "default": "h2"
        }
      ]
    },
    {
      "type": "price",
      "name": "Price",
      "settings": []
    },
    {
      "type": "text",
      "name": "Text",
      "settings": [
        {
          "type": "richtext",
          "id": "text",
          "label": "Text"
        }
      ]
    },
    {
      "type": "variant_picker",
      "name": "Variant picker",
      "settings": []
    },
    {
      "type": "buy_buttons",
      "name": "Buy buttons",
      "settings": [
        {
          "type": "checkbox",
          "id": "show_dynamic_checkout",
          "label": "Show dynamic checkout button",
          "default": true
        }
      ]
    }
  ],

  "presets": [
    {
      "name": "Featured product",
      "category": "Products",
      "settings": {
        "color_scheme": "scheme-3"
      },
      "blocks": [
        { "type": "media" },
        { "type": "title" },
        { "type": "price" },
        { "type": "variant_picker" },
        { "type": "buy_buttons" }
      ]
    }
  ]
}
{% endschema %}
