{% comment %} Image Tabs (Swiper-synced) â€” clean liquid, JS in assets/image-tabs.js {% endcomment %}

{{ 'component-image-with-text.css' | asset_url | stylesheet_tag }}

{%- style -%}
.image-tabs-{{ section.id }} { --gap: 32px; --pill: {{ section.settings.pill_color }}; width: calc(100vw - 11px); }

/* Grid: 50/50 on desktop */
.image-tabs-{{ section.id }} .grid {
  display: flex; gap: var(--gap); flex-wrap: wrap;
}
@media (min-width: 990px) {
  .image-tabs-{{ section.id }} .grid .image-tabs__tabs { padding-top: 100px; display: flex; flex-direction: column; justify-content: space-between; }
  .image-tabs-{{ section.id }} .grid .image-tabs__image { max-height: calc(100vh - 100px); overflow: hidden; }
  .image-tabs-{{ section.id }} .grid .image-tabs__tabs,
  .image-tabs-{{ section.id }} .grid .image-tabs__image { flex: 0 0 calc(50% - (var(--gap) / 2)); }
  .image-tabs-{{ section.id }} .image-slide .media { aspect-ratio: 1 / 1; }
  .image-tabs-{{ section.id }}.reverse .grid { flex-direction: row-reverse; }
  .image-tabs-{{ section.id }} .title { font-size: 28px !important; }
}
@media (max-width: 989px) {
    .image-tabs-{{ section.id }} .grid {
        flex-direction: column;
    }
    image-tabs-{{ section.id }} .grid .image-tabs__tabs,
    .image-tabs-{{ section.id }} .grid .image-tabs__image {
        flex: 0 0 100%;
    }
    .image-tabs-{{ section.id }} .title { font-size: 20px !important; }
    .image-tabs-{{ section.id }} .below-text p { font-size: 16px !important; }
    .image-tabs-{{ section.id }} .below-text p strong { font-size: 14px !important; }
    .image-tabs-{{ section.id }} .pill { height: 24px !important; }
}

/* Section padding */
.image-tabs-{{ section.id }} .section-padding {
  padding-top: {{ section.settings.padding_top | times: 0.75 | round: 0 }}px;
  padding-bottom: 0;
  /* padding-bottom: {{ section.settings.padding_bottom | times: 0.75 | round: 0 }}px; */
}
@media (min-width: 750px) {
  .image-tabs-{{ section.id }} .section-padding {
    padding-top: {{ section.settings.padding_top }}px;
    padding-bottom: {{ section.settings.padding_bottom }}px;
  }
}

/* Eyebrow + below text */
.image-tabs-{{ section.id }} .eyebrow {
  display: flex; gap: 12px; justify-content: flex-start; align-items: center;
  font-size: 14px; font-weight: 300; margin-bottom: 35px;
}
.image-tabs-{{ section.id }} .eyebrow img { height: 14px; width: auto; }
.image-tabs-{{ section.id }} .below-text { margin-top: 35px; max-width: 600px; }
.image-tabs-{{ section.id }} .below-text p { font-size: 20px; font-weight: 300; }
.image-tabs-{{ section.id }} .below-text p strong { font-family: 'Monument Extended', sans-serif !important; text-transform: uppercase; font-size: 18px; font-weight: 400 !important; }

/* Tabs list */
.image-tabs-{{ section.id }} .tabs .swiper-wrapper { display: flex; flex-direction: column; height: auto; }
.image-tabs-{{ section.id }} .tab {
  display: grid; grid-template-columns: auto 1fr; gap: 0; align-items: center;
  padding-block: 4px; cursor: pointer; user-select: none;
}
.image-tabs-{{ section.id }} .tab:last-child { border-bottom: 0; }

.image-tabs-{{ section.id }} .pill {
  height: 28px; width: 0; border-radius: 999px; background: var(--pill);
  transition: width .45s cubic-bezier(.22,.61,.36,1), transform .45s cubic-bezier(.22,.61,.36,1), margin .25s ease;
  transform-origin: left; margin-right: 0;
}
.image-tabs-{{ section.id }} .tab.is-active .pill { width: 56px; transform: scaleX(1); margin-right: 12px; }

.image-tabs-{{ section.id }} .title {
line-height: 1; text-decoration: none; color: rgb(var(--color-foreground)); padding-top: 4px;
  opacity: .25; transition: opacity .25s ease;
}
.image-tabs-{{ section.id }} .tab.is-active .title { opacity: 1; }

.image-tabs-{{ section.id }} .image-pane {
    position: relative;
    overflow: hidden; 
    height: 100%;
}

/* Make swiper take full pane size */
.image-tabs-{{ section.id }} .image-pane .swiper { width: 100% !important; height: auto; }
.image-tabs-{{ section.id }} .image-pane .swiper-wrapper { width: 100%; }
/* .image-tabs-{{ section.id }} .image-pane .swiper-slide { width: 100%; height: var(--pane-size) !important; margin: 0 !important; } */

.image-tabs-{{ section.id }} .image-slide .media { position: relative; width:100%; height:100%; }
.image-tabs-{{ section.id }} .image-slide .media,
.image-tabs-{{ section.id }} .image-slide .media > * { margin: 0 !important; }
.image-tabs-{{ section.id }} .image-slide img { width: 100%; height: 100%; object-fit: cover; object-position: center center; display:block; border-radius: 10px; }

.image-tabs-{{ section.id }} .image-pane .swiper { box-sizing: content-box; padding-bottom: 20px; }
.image-tabs-{{ section.id }} .image-pane .swiper-wrapper { box-sizing: content-box; }

/* Overlay text (per-image) */
.image-tabs-{{ section.id }} .img-overlay {
  position: absolute; z-index: 2; top: 20px; left: 20px; margin: 0; padding: 0;
  font-size: 16px; max-width: 400px; line-height: 1.05;
}

/* Pagination bullets: vertical top-right desktop, centered row mobile */
.image-tabs-{{ section.id }} .image-pagination {
  position: absolute; right: 20px; top: 20px; bottom: auto; left: auto; z-index: 3;
  display: flex; flex-direction: column; gap: 0px; width: 10px !important; transform: none;
}
.image-tabs-{{ section.id }} .image-pagination .swiper-pagination-bullet {
  width: 10px; height: 10px; border-radius: 10px; opacity: .4; background: #fff !important;
  transition: height .2s ease, opacity .2s ease;
}
.image-tabs-{{ section.id }} .image-pagination .swiper-pagination-bullet-active { opacity: 1; background: var(--pill) !important; }
@media (max-width: 989px) {
  .image-tabs-{{ section.id }} .image-pagination { left: 0; right: 0; bottom: 10px; flex-direction: row; justify-content: center; width: auto !important; }
}
{%- endstyle -%}

{% if section.index == 1 %}
  {% assign fetch_priority = "high" %}
{% else %}
  {% assign fetch_priority = "auto" %}
{% endif %}

<section
  class="image-tabs-{{ section.id }} color-{{ section.settings.section_color_scheme }}{% if section.settings.layout == 'image_left' %} reverse{% endif %}"
  data-component="image-tabs"
  data-section-id="{{ section.id }}"
>
  <div class="section-padding">
    <div class="grid">

      <!-- LEFT: tabs -->
      <div class="image-tabs__tabs">
        <div class="image-tabs__tabs_inner">
          {% if section.settings.eyebrow != blank %}
            <p class="eyebrow">
              {% if section.settings.eyebrow_icon != blank %}
                {{ section.settings.eyebrow_icon | image_url: width: 40 | image_tag: loading: 'lazy' }}
              {% endif %}
              {{ section.settings.eyebrow }}
            </p>
          {% endif %}

          {% if section.settings.heading != blank %}
            <h2 class="title inline-richtext {{ section.settings.heading_size }}" style="margin:0 0 16px">{{ section.settings.heading }}</h2>
          {% endif %}

          <div id="Tabs-{{ section.id }}" class="swiper tabs"
               data-autoplay="{{ section.settings.autoplay }}"
               data-delay="{{ section.settings.autoplay_delay | times: 1000 }}"
               data-loop="{{ section.settings.loop }}">
            <div class="swiper-wrapper">
              {% for block in section.blocks %}
                <div class="swiper-slide tab" {{ block.shopify_attributes }} data-index="{{ forloop.index0 }}" tabindex="0" role="button" aria-label="{{ block.settings.title | escape }}">
                  <span class="pill" aria-hidden="true"></span>
                  <a {% if block.settings.button_link == blank %} role="link" aria-disabled="true" {% else %} href="{{ block.settings.button_link }}"{% endif %} class="h3 title">
                    {{ block.settings.title }}
                  </a>
                </div>
              {% endfor %}
            </div>
          </div>
        </div>

        {% if section.settings.below_text != blank %}
          <div class="below-text rte">{{ section.settings.below_text }}</div>
        {% endif %}
      </div>

      <!-- RIGHT: images -->
      <div class="image-tabs__image">
        <div id="Images-{{ section.id }}" class="swiper image-pane" data-space="{{ section.settings.image_gap }}">
          <div class="swiper-wrapper">
            {% for block in section.blocks %}
              <div class="swiper-slide image-slide">
                <div class="media">
                  {% if block.settings.image != blank %}
                    {% assign widths = '600, 900, 1200, 1600, 2000' %}
                    {% capture sizes %}(min-width: 1200px) 50vw, (min-width: 750px) 50vw, 100vw{% endcapture %}
                    {{ block.settings.image | image_url: width: 2000 | image_tag: widths: widths, sizes: sizes, fetchpriority: fetch_priority }}
                  {% else %}
                    {{ 'lifestyle-1' | placeholder_svg_tag: 'placeholder-svg' }}
                  {% endif %}

                  {% if block.settings.overlay_text != blank %}
                    <p class="img-overlay"{% if block.settings.overlay_color != blank %} style="color: {{ block.settings.overlay_color }}"{% endif %}>
                      {{ block.settings.overlay_text | escape }}
                    </p>
                  {% endif %}

                  {% if block.settings.button_label != blank %}
                    <a {% if block.settings.button_link == blank %} role="link" aria-disabled="true" {% else %} href="{{ block.settings.button_link }}"{% endif %}
                       class="button button--primary button--small img-btn">{{ block.settings.button_label | escape }}</a>
                  {% endif %}
                </div>
              </div>
            {% endfor %}
          </div>

          <div class="swiper-pagination image-pagination"></div>
        </div>
      </div>

    </div>
  </div>
</section>

{% schema %}
{
  "name": "Image Tabs",
  "class": "section",
  "disabled_on": { "groups": ["header", "footer"] },
  "settings": [
    { "type": "image_picker", "id": "eyebrow_icon", "label": "Eyebrow icon" },
    { "type": "text", "id": "eyebrow", "label": "Subheading (eyebrow)", "default": "A new era of sports protection" },
    { "type": "inline_richtext", "id": "heading", "label": "Heading", "default": "Iconic design" },
    { "type": "select", "id": "heading_size", "label": "Heading size", "default": "h2", "options": [
      { "value": "h2", "label": "H2" }, { "value": "h1", "label": "H1" }, { "value": "h0", "label": "H0" }
    ]},
    { "type": "richtext", "id": "below_text", "label": "Text below tabs", "default": "<p>We exist to revolutionise protective sports equipment &amp; keep you playing the sport you love. Longer.</p>" },
    { "type": "select", "id": "layout", "label": "Layout (desktop)", "default": "image_right", "options": [
      { "value": "image_right", "label": "Image right" },
      { "value": "image_left",  "label": "Image left" }
    ]},
    { "type": "checkbox", "id": "autoplay", "label": "Autoplay", "default": true },
    { "type": "range", "id": "autoplay_delay", "label": "Autoplay delay (seconds)", "min": 2, "max": 15, "step": 1, "default": 5 },
    { "type": "checkbox", "id": "loop", "label": "Loop slides", "default": true },
    { "type": "range", "id": "image_gap", "label": "Image stack gap (px)", "min": 0, "max": 40, "step": 2, "default": 16 },
    { "type": "color", "id": "pill_color", "label": "Active pill color", "default": "#0FE694" },
    { "type": "color_scheme", "id": "section_color_scheme", "label": "Section color scheme", "default": "scheme-1" },
    { "type": "range", "id": "padding_top", "min": 0, "max": 120, "step": 4, "unit": "px", "label": "Top padding", "default": 40 },
    { "type": "range", "id": "padding_bottom", "min": 0, "max": 120, "step": 4, "unit": "px", "label": "Bottom padding", "default": 40 }
  ],
  "blocks": [
    {
      "type": "tab",
      "name": "Tab",
      "settings": [
        { "type": "text", "id": "title", "label": "Title", "default": "Iconic Design" },
        { "type": "text", "id": "button_label", "label": "Button label" },
        { "type": "url",  "id": "button_link", "label": "Button link" },
        { "type": "image_picker", "id": "image", "label": "Image" },
        { "type": "text", "id": "overlay_text", "label": "Overlay text" },
        { "type": "color", "id": "overlay_color", "label": "Overlay text color" }
      ]
    }
  ],
  "presets": [{ "name": "Image Tabs", "blocks": [{ "type": "tab" }, { "type": "tab" }, { "type": "tab" }] }]
}
{% endschema %}
