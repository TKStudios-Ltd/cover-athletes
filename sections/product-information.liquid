

{% liquid
  if section.settings.desktop_media_position == 'left'
    assign render_order = 'media,product-details'
  else
    assign render_order = 'product-details,media'
  endif

  assign product_has_media = true
  if closest.product.media.size == 0
    assign product_has_media = false
  endif

  assign product_grid_class = 'product-information__grid'

  if product_has_media == false
    assign product_grid_class = product_grid_class | append: ' product-information--media-none'
  elsif section.settings.desktop_media_position == 'right'
    assign product_grid_class = product_grid_class | append: ' product-information--media-right'
  else
    assign product_grid_class = product_grid_class | append: ' product-information--media-left'
  endif

  if section.settings.equal_columns
    assign product_grid_class = product_grid_class | append: ' product-information__grid--half'

    if section.settings.limit_details_width
      assign product_grid_class = product_grid_class | append: ' product-information__grid--limit-details'
    endif
  endif

  case section.settings.content_width
    when 'content-center-aligned'
      assign content_width = 'page-width'
    when 'content-full-width'
      assign content_width = 'full-width'
  endcase
%}

<script type="application/ld+json">
  {{ closest.product | structured_data }}
</script>

<div class="section-background color-{{ section.settings.color_scheme }}"></div>

  <div
    class="product-information section section--{{ content_width }} spacing-style color-{{ section.settings.color_scheme }} relative"
    data-product-info-root
    style="{% render 'spacing-style', settings: section.settings %} --gap: {{ section.settings.gap }}px;"
  >
  {% if section.settings.desktop_media_position == 'left' and product_has_media %}
    {% assign product_href = '#ProductInformation-' | append: section.id %}
    {% render 'skip-to-content-link', href: product_href, text: 'accessibility.skip_to_product_info' %}
  {% endif %}

  <div class="{{ product_grid_class }}" data-product-grid-content>
    {% assign render_order_array = render_order | split: ',' %}

    {% capture media %}
      <div
        class="product-information__media has-custom-horizontal-gallery"
        data-testid="product-information-media"
      >
        <div class="custom-horizontal-gallery-wrapper">
          <div class="custom-horizontal-gallery" data-drag-scroll>
            {% for media in closest.product.media %}
              {% if media.media_type == 'image' %}
                <div class="gallery-item">
                  {{ media | image_url: width: 2400 | image_tag: loading: 'eager' }}
                </div>
              {% endif %}
            {% endfor %}
          </div>
        </div>

        {%- content_for 'block',
          type: '_product-media-gallery',
          id: 'media-gallery',
          closest.product: closest.product
        -%}
      </div>
    {% endcapture %}

    {% capture details %}
      {% content_for 'block',
        type: '_product-details',
        id: 'product-details',
        closest.product: closest.product
      %}
    {% endcapture %}

    {% for block in render_order_array %}
      {% if block == 'media' and product_has_media %}
        {{ media }}
      {% elsif block == 'product-details' %}
        {{ details }}
      {% endif %}
    {% endfor %}
  </div>

  {% content_for 'blocks' %}
</div>



{% stylesheet %}

/* ======================================
   BASE PRODUCT INFORMATION
   ====================================== */

.product-information {
  position: relative;
  gap: var(--gap) 0;
  overflow: hidden;
  --section-top-offset: 0 !important;
}

.product-information__grid {
  display: grid;
  grid-template-columns: subgrid;
  grid-column: 1 / -1;
}

.product-information__media {
  order: 0;
  width: 0;
  min-width: 100%;
}

.product-details {
  order: 1;
  position: relative;
  z-index: 2;
  height: 100%;
  padding-bottom: 40px;
  align-items: flex-end;
  justify-content: flex-end;
}
.product-details > .group-block {
  backdrop-filter: blur(10px);
  max-width: 400px;
}

/* ======================================
   CUSTOM HORIZONTAL GALLERY â€“ LAYOUT
   ====================================== */

.product-information__media.has-custom-horizontal-gallery {
  position: relative;
  width: 100%;
  min-width: 100%;
  height: calc(100vw - 480px);
  max-height: 600px;
  overflow: visible;
}

/* Pull gallery out of grid and columns */
.custom-horizontal-gallery-wrapper {
  position: absolute;
  top: 0;
  left: 0;
  width: 100vw;
  max-width: 100vw;
  z-index: 1;
  pointer-events: auto;
}

/* Hide ALL native Ritual media output */
.product-information__media.has-custom-horizontal-gallery
  > :not(.custom-horizontal-gallery-wrapper) {
  position: absolute !important;
  inset: 0;
  opacity: 0;
  pointer-events: none;
}

/* ======================================
   HORIZONTAL SCROLL CONTAINER
   ====================================== */

.custom-horizontal-gallery {
  display: flex;
  align-items: center;
  gap: 25px;
  padding: 0;
  overflow-x: scroll;
  overflow-y: hidden;
  -webkit-overflow-scrolling: touch;
  scroll-snap-type: none;
  scrollbar-width: none;
}

.custom-horizontal-gallery::-webkit-scrollbar {
  width: 0;
  height: 0;
  display: none;
}

/* ======================================
   GALLERY ITEMS + IMAGE HEIGHT
   ====================================== */

.gallery-item {
  flex: 0 0 auto;
  width: auto;
  display: flex;
  align-items: center;
}

.gallery-item img {
  width: auto;
  height: calc(100vw - 480px);
  max-height: 600px;
  display: block;
  pointer-events: none;
}

/* ======================================
   CURSOR (MATCH WORKING SECTION)
   ====================================== */

.custom-horizontal-gallery,
.custom-horizontal-gallery * {
  cursor: url("/cdn/shop/t/3/assets/cursor-drag.svg") 20 20, grab !important;
}

.custom-horizontal-gallery:active,
.custom-horizontal-gallery:active * {
  cursor: grabbing !important;
}

/* ======================================
   ALLOW CURSOR TO PASS THROUGH DETAILS
   ====================================== */

/* Let pointer events reach gallery underneath */
.product-details {
  pointer-events: none;
}

/* Re-enable interaction inside details */
.product-details * {
  pointer-events: auto;
}

/* ======================================
   MOBILE BEHAVIOUR
   ====================================== */

@media (max-width: 749px) {
  .custom-horizontal-gallery-wrapper {
    display: none;
  }

  .product-information__media.has-custom-horizontal-gallery {
    padding-bottom: 0;
  }
}

/* ======================================
   RITUAL GRID BEHAVIOUR (UNCHANGED)
   ====================================== */

@media screen and (max-width: 749px) {
  .product-information__media {
    grid-column: 1 / -1;
  }

  .product-details {
    grid-column: 2 / 3;
  }
}

@media screen and (min-width: 750px) {
  .product-information__grid {
    grid-column: 2;
  }

  .product-information__grid.product-information--media-none,
  .product-information__grid:has(.product-information__media:empty) {
    .product-details {
      width: var(--narrow-content-width);
      margin: 0 auto;
    }
  }

  .product-information__grid:not(:has(.product-information__media:empty)) {
    &.product-information--media-left {
      grid-template-columns: 1fr min(50vw, var(--sidebar-width));

      .product-information__media {
        padding-right: calc(var(--gap, 0) / 2);
      }

      .product-details {
        padding-left: calc(var(--gap, 0) / 2);
      }
    }

    &.product-information--media-right {
      grid-template-columns: min(50vw, var(--sidebar-width)) 1fr;

      .product-information__media {
        padding-left: calc(var(--gap, 0) / 2);
        order: 1;
      }

      .product-details {
        padding-right: calc(var(--gap, 0) / 2);
        order: 0;
      }
    }

    &.product-information__grid--half {
      grid-column: 1 / -1;
      grid-template-columns:
        var(--full-page-grid-margin)
        calc(var(--full-page-grid-central-column-width) / 2)
        calc(var(--full-page-grid-central-column-width) / 2)
        var(--full-page-grid-margin);
    }
  }

  .section--full-width {
    .product-information__grid:not(:has(.product-information__media:empty)) {
      grid-column: 1 / -1;
    }
  }
}

@media screen and (min-width: 1200px) {
  .product-information__grid:not(
      .product-information__grid--half,
      :has(.product-information__media:empty)
    ).product-information--media-left {
    grid-template-columns: 2fr 1fr;
  }

  .product-information__grid:not(
      .product-information__grid--half,
      :has(.product-information__media:empty)
    ).product-information--media-right {
    grid-template-columns: 1fr 2fr;
  }
}

{% endstylesheet %}



{% schema %}
{
  "name": "t:names.product_information",
  "blocks": [
    {
      "type": "@app"
    }
  ],
  "disabled_on": {
    "groups": ["header", "footer"]
  },
  "settings": [
    {
      "type": "header",
      "content": "t:content.layout"
    },
    {
      "type": "select",
      "id": "content_width",
      "label": "t:settings.width",
      "options": [
        {
          "value": "content-center-aligned",
          "label": "t:options.page"
        },
        {
          "value": "content-full-width",
          "label": "t:options.full"
        }
      ],
      "default": "content-center-aligned"
    },
    {
      "type": "select",
      "id": "desktop_media_position",
      "label": "t:settings.media_position",
      "options": [
        {
          "value": "left",
          "label": "t:options.left"
        },
        {
          "value": "right",
          "label": "t:options.right"
        }
      ],
      "default": "left"
    },
    {
      "type": "checkbox",
      "id": "equal_columns",
      "label": "t:settings.equal_columns",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "limit_details_width",
      "label": "t:settings.limit_product_details_width",
      "default": false,
      "visible_if": "{{ section.settings.equal_columns }}"
    },
    {
      "type": "range",
      "id": "gap",
      "label": "t:settings.gap",
      "min": 0,
      "max": 48,
      "step": 4,
      "unit": "px",
      "default": 16
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "t:settings.color_scheme",
      "default": "scheme-1"
    },
    {
      "type": "header",
      "content": "t:content.padding"
    },
    {
      "type": "range",
      "id": "padding-block-start",
      "label": "t:settings.top",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "padding-block-end",
      "label": "t:settings.bottom",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 0
    }
  ],
  "presets": []
}
{% endschema %}
