{% comment %}
  R&D Slider â€” Uses Swiper (rd-slider.js handles autoplay, pause on hover, drag cursor)
{% endcomment %}

{{ 'rd-slider.js' | asset_url | script_tag }}

{%- style -%}
.rd-slider {
  position: relative;
  width: 100%;
  overflow: hidden;
}

.rd-slider .swiper {
  width: 100%;
}

.rd-slider .swiper-wrapper {
  display: flex;
}

.rd-slide {
  position: relative;
  width: 100%;
  cursor: url("{{ 'cursor-drag.svg' | asset_url }}") 20 20, grab;
}

.rd-slide:active {
  cursor: grabbing;
}

.rd-slide__media {
  position: relative;
  width: 100%;
  overflow: hidden;
  border-radius: 14px;
}

.rd-ratio--square {
  aspect-ratio: 1/1;
}

.rd-ratio--tall {
  aspect-ratio: 3/4;
}

.rd-slide__media img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
}

.rd-slide__overlay {
  position: absolute;
  inset: 0;
  background: rgba(0,0,0,0.25);
  border-radius: 14px;
}

.rd-slide__content {
  position: absolute;
  inset: 0;
  padding: 20px;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  pointer-events: none;
}

.rd-slide__title {
  font-size: 22px;
  font-weight: 600;
  color: #fff;
  text-shadow: 0px 2px 8px rgba(0,0,0,0.4);
  max-width: 70%;
}

.rd-slide__button {
  pointer-events: auto;
  display: inline-block;
  padding: 10px 16px;
  background: #fff;
  color: #000;
  border-radius: 6px;
  font-size: 14px;
  font-weight: 600;
  text-decoration: none;
}

.rd-slide__icon {
  position: absolute;
  right: 20px;
  bottom: 20px;
  width: 54px;
  height: 54px;
  pointer-events: none;
}

.rd-slide__icon img {
  width: 100%;
  height: 100%;
  object-fit: contain;
}
{%- endstyle -%}

<section
  class="rd-slider rd-slider--{{ section.id }} color-{{ section.settings.color_scheme }}"
  data-rd-slider
  data-autoplay="{{ section.settings.autoplay }}"
  data-delay="{{ section.settings.delay | times: 1000 }}"
>
  <div id="rd-swiper-{{ section.id }}" class="swiper rd-slider__inner">
    <div class="swiper-wrapper">

      {% for block in section.blocks %}
        <div class="swiper-slide rd-slide" {{ block.shopify_attributes }}>

          <div class="rd-slide__media rd-ratio--{{ block.settings.ratio }}">
            {% if block.settings.image %}
              {{ block.settings.image | image_url: width: 2000 | image_tag }}
            {% else %}
              {{ 'image' | placeholder_svg_tag }}
            {% endif %}
          </div>

          <div class="rd-slide__overlay"></div>

          <div class="rd-slide__content">

            {% if block.settings.title != blank %}
              <h3 class="rd-slide__title">{{ block.settings.title }}</h3>
            {% endif %}

            {% if block.settings.link != blank %}
              <a class="rd-slide__button" href="{{ block.settings.link }}">
                {{ block.settings.link_label | default: "Learn more" }}
              </a>
            {% endif %}

            {% if block.settings.icon %}
              <div class="rd-slide__icon">
                {{ block.settings.icon | image_url: width: 100 | image_tag }}
              </div>
            {% endif %}

          </div>
        </div>
      {% endfor %}

    </div>
  </div>
</section>

{% schema %}
{
  "name": "R&D Slider",
  "settings": [
    { "type": "checkbox", "id": "autoplay", "label": "Autoplay", "default": true },
    { "type": "range", "id": "delay", "label": "Autoplay delay (sec)", "min": 2, "max": 12, "step": 1, "default": 5 },
    { "type": "color_scheme", "id": "color_scheme", "label": "Color scheme", "default": "scheme-1" }
  ],
  "blocks": [
    {
      "type": "slide",
      "name": "Slide",
      "settings": [
        { "type": "image_picker", "id": "image", "label": "Background image" },
        { "type": "select", "id": "ratio", "label": "Slide ratio", "default": "square", "options": [
          { "value": "square", "label": "1:1" },
          { "value": "tall", "label": "3:4" }
        ]},
        { "type": "text", "id": "title", "label": "Title" },
        { "type": "url", "id": "link", "label": "Link URL" },
        { "type": "text", "id": "link_label", "label": "Link label", "default": "Learn more" },
        { "type": "image_picker", "id": "icon", "label": "Bottom-right icon" }
      ]
    }
  ],
  "presets": [
    { "name": "R&D Slider" }
  ]
}
{% endschema %}
