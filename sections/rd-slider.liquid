{% comment %}
RD Slider â€” block-level color scheme, ratios, overlay, title width, icon height
{% endcomment %}

<section
  class="rd-slider rd-slider-{{ section.id }}"
  data-section-id="{{ section.id }}"
  data-autoplay="{{ section.settings.autoplay }}"
  data-delay="{{ section.settings.delay }}"
>
  <div class="rd-slider__inner" style="
    --pad-top: {{ section.settings.padding_top }}px;
    --pad-bottom: {{ section.settings.padding_bottom }}px;
  ">

    <div class="swiper rd-swiper" id="RDSlider-{{ section.id }}">
      <div class="swiper-wrapper">

        {% for block in section.blocks %}
        <div
          class="swiper-slide rd-slide color-{{ block.settings.color_scheme }} ratio-{{ block.settings.ratio }}"
          {{ block.shopify_attributes }}
          style="
            --title-max-width: {{ block.settings.title_max_width }}px;
            --overlay-opacity: {{ block.settings.overlay_opacity }};
            --icon-height: {{ block.settings.icon_height }}px;
          "
        >

          <div class="rd-slide__media">
            {% if block.settings.image != blank %}
              {{ block.settings.image | image_url: width: 2000 | image_tag: loading: 'lazy' }}
            {% endif %}
            <div class="rd-slide__overlay"></div>
          </div>

          <div class="rd-slide__content">
            {% if block.settings.title != blank %}
              <h5 class="rd-slide__title">{{ block.settings.title }}</h5>
            {% endif %}

            {% if block.settings.link_label != blank and block.settings.link_url != blank %}
              <a href="{{ block.settings.link_url }}" class="rd-slide__link link">
                {{ block.settings.link_label }}
                <span class="arrow-wrapper">
                    {{- 'icon-arrow-alt.svg' | inline_asset_content -}}
                </span>
            </a>
            {% endif %}
          </div>

          {% if block.settings.icon != blank %}
            <div class="rd-slide__icon">
              {{ block.settings.icon | image_url: width: 200 | image_tag }}
            </div>
          {% endif %}

        </div>
        {% endfor %}

      </div>
    </div>

  </div>
</section>

<style>
.rd-slider { width: 100%; }

.rd-slider__inner {
    padding-top: var(--pad-top);
    padding-bottom: var(--pad-bottom);
}

/* CURSOR */
.rd-swiper,
.rd-swiper .rd-slide,
.rd-swiper .rd-slide__media,
.rd-swiper .rd-slide__content,
.rd-swiper .rd-slide__overlay,
.rd-swiper .rd-slide__icon {
    cursor: url("{{ 'cursor-drag.svg' | asset_url }}") 20 20, grab !important;
}
.rd-swiper:active *,
.rd-swiper:active {
    cursor: grabbing !important;
}

.rd-slide a,
.rd-slide a *,
.rd-slide__link,
.rd-slide__link * {
    cursor: pointer !important;
    pointer-events: auto !important;
    z-index: 10 !important;
    position: relative;
}

/* === SLIDES === */
.rd-slide {
  position: relative;
  overflow: hidden;
  border-radius: 10px;
  width: calc(30% - 20px);
}
@media (max-width: 749px) {
  .rd-slide { width: 80%; }
}

.rd-swiper .swiper-wrapper { display: flex; }
.rd-swiper .swiper-slide { flex-shrink: 0; }

/* === RATIOS === */
.rd-slide__media { position: relative; background: rgb(var(--color-background)); }
.rd-slide__media img { width: 100%; height: 100%; object-fit: cover; }

.rd-slide.ratio-square .rd-slide__media { aspect-ratio: 1/1; }
.rd-slide.ratio-54 .rd-slide__media { aspect-ratio: 5/4; }
.rd-slide.ratio-45 .rd-slide__media { aspect-ratio: 4/5; }

/* === OVERLAY === */
.rd-slide__overlay {
  position: absolute;
  inset: 0;
  background: rgba(0, 0, 0, calc(var(--overlay-opacity) / 10));
  z-index: 1;
  pointer-events: none;
}

/* === CONTENT === */
.rd-slide__content {
  position: absolute;
  inset: 0;
  {% comment %} padding: 24px; {% endcomment %}
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  color: var(--color-foreground);
  z-index: 3;
}

.rd-slide__title {
    font-size: 28px;
    font-weight: 200;
    line-height: 1;
    letter-spacing: -0.03em;
    text-transform: inherit;
    max-width: calc(var(--title-max-width) + 48px);
    padding: 24px;
    margin-bottom: 0;
}
.rd-slide__title em {
    color: #959595;
    font-style: normal;
}

.rd-slide__link {
  padding: 24px;
}

.rd-slide__icon {
  position: absolute;
  bottom: 24px;
  right: 24px;
  z-index: 4;
}
.rd-slide__icon img {
  height: var(--icon-height, 24px);
  width: auto;
}
</style>

{% schema %}
{
  "name": "RD Slider",
  "settings": [
    { "type": "range", "id": "padding_top", "min": 0, "max": 120, "step": 5, "label": "Padding top", "default": 60 },
    { "type": "range", "id": "padding_bottom", "min": 0, "max": 120, "step": 5, "label": "Padding bottom", "default": 60 },

    { "type": "checkbox", "id": "autoplay", "label": "Autoplay", "default": true },
    { "type": "range", "id": "delay", "min": 2, "max": 12, "step": 1, "label": "Autoplay delay (sec)", "default": 5 }
  ],

  "blocks": [
    {
      "type": "slide",
      "name": "Slide",
      "settings": [
        { "type": "color_scheme", "id": "color_scheme", "label": "Color scheme" },
        { "type": "image_picker", "id": "image", "label": "Background image" },
        { "type": "inline_richtext", "id": "title", "label": "Title" },
        { "type": "text", "id": "link_label", "label": "Link label" },
        { "type": "url", "id": "link_url", "label": "Link URL" },
        { "type": "image_picker", "id": "icon", "label": "Bottom-right icon" },

        {
          "type": "select",
          "id": "ratio",
          "label": "Slide ratio",
          "default": "square",
          "options": [
            { "value": "square", "label": "Square (1:1)" },
            { "value": "54", "label": "Short (5:4)" },
            { "value": "45", "label": "Tall (4:5)" }
          ]
        },

        { "type": "range", "id": "title_max_width", "min": 120, "max": 600, "step": 10, "label": "Title max-width (px)", "default": 240 },

        { "type": "range", "id": "overlay_opacity", "min": 0, "max": 8, "step": 1, "label": "Background overlay opacity", "default": 0 },

        { "type": "range", "id": "icon_height", "min": 16, "max": 120, "step": 2, "label": "Icon height (px)", "default": 24 }
      ]
    }
  ],

  "presets": [
    { "name": "RD Slider", "blocks": [{ "type": "slide" }, { "type": "slide" }, { "type": "slide" }] }
  ]
}
{% endschema %}
