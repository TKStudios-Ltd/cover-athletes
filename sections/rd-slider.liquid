{% comment %}
  RD Slider â€” custom Swiper slider for R&D content
  JS in assets/rd-slider.js
{% endcomment %}

{{ 'component-image-with-text.css' | asset_url | stylesheet_tag }}
{{ 'rd-slider.js' | asset_url | stylesheet_tag }}

{%- style -%}
.rd-slider-{{ section.id }} {
  position: relative;
  width: 100%;
}

.rd-slider-{{ section.id }} .rd-swiper {
  width: 100%;
  overflow: visible;
  cursor: url("{{ 'cursor-drag.svg' | asset_url }}") 20 20, grab;
}

.rd-slider-{{ section.id }} .swiper-wrapper {
  display: flex;
  align-items: stretch;
}

.rd-slider-{{ section.id }} .swiper-slide {
  flex: 0 0 auto;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  overflow: hidden;
  border-radius: 16px;
  position: relative;
  padding: 24px;
  color: var(--color-foreground, #ffffff);
  transition: transform .3s ease;
}

.rd-slider-{{ section.id }} .swiper-slide:hover {
  cursor: url("{{ 'cursor-drag.svg' | asset_url }}") 20 20, grab;
}

.rd-slider-{{ section.id }} .slide-bg {
  position: absolute;
  inset: 0;
  z-index: 1;
}
.rd-slider-{{ section.id }} .slide-bg img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.rd-slider-{{ section.id }} .slide-content {
  position: relative;
  z-index: 3;
  display: flex;
  flex-direction: column;
  height: 100%;
  justify-content: space-between;
}

.rd-slider-{{ section.id }} .slide-title {
  font-size: 24px;
  line-height: 1.2;
  font-weight: 600;
  max-width: 320px;
}

.rd-slider-{{ section.id }} .slide-link a {
  font-size: 15px;
  font-weight: 600;
  text-decoration: underline;
}

.rd-slider-{{ section.id }} .slide-icon img {
  width: 48px;
  height: auto;
}

/* ratio containers per block */
.rd-slider-{{ section.id }} .ratio-box {
  width: 100%;
  position: relative;
}

.rd-slider-{{ section.id }} .ratio-1-1 { padding-top: 100%; }
.rd-slider-{{ section.id }} .ratio-4-5 { padding-top: 125%; }
.rd-slider-{{ section.id }} .ratio-3-4 { padding-top: 135%; }

/* inner absolute layer */
.rd-slider-{{ section.id }} .ratio-box > .ratio-inner {
  position: absolute;
  inset: 0;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  padding: 24px;
}
{%- endstyle -%}

<section
  class="rd-slider-{{ section.id }}"
  data-section-id="{{ section.id }}"
  data-component="rd-slider"
  data-autoplay="{{ section.settings.autoplay }}"
  data-delay="{{ section.settings.delay | times: 1000 }}"
>
  <div class="rd-swiper swiper" id="RDSwiper-{{ section.id }}">
    <div class="swiper-wrapper">

      {% for block in section.blocks %}
        {% assign ratio = block.settings.ratio %}
        <div class="swiper-slide color-{{ block.settings.color_scheme }}" {{ block.shopify_attributes }}>
          
          <div class="ratio-box ratio-{{ ratio }}">
            <div class="slide-bg">
              {% if block.settings.image != blank %}
                {{ block.settings.image | image_url: width: 2000 | image_tag: loading: 'lazy' }}
              {% endif %}
            </div>

            <div class="ratio-inner">
              <div class="slide-content">
                {% if block.settings.title != blank %}
                  <div class="slide-title">{{ block.settings.title }}</div>
                {% endif %}

                <div class="bottom">
                  {% if block.settings.link_url != blank %}
                    <div class="slide-link">
                      <a href="{{ block.settings.link_url }}">{{ block.settings.link_label }}</a>
                    </div>
                  {% endif %}

                  {% if block.settings.icon != blank %}
                    <div class="slide-icon">
                      {{ block.settings.icon | image_url: width: 60 | image_tag }}
                    </div>
                  {% endif %}
                </div>

              </div>
            </div>

          </div>
        </div>
      {% endfor %}

    </div>
  </div>
</section>

{% schema %}
{
  "name": "RD Slider",
  "class": "section",
  "settings": [
    {
      "type": "checkbox",
      "id": "autoplay",
      "label": "Autoplay slides",
      "default": true
    },
    {
      "type": "range",
      "id": "delay",
      "label": "Autoplay delay (seconds)",
      "min": 3,
      "max": 12,
      "step": 1,
      "default": 5
    }
  ],
  "blocks": [
    {
      "type": "slide",
      "name": "Slide",
      "settings": [
        { "type": "image_picker", "id": "image", "label": "Background image" },
        { "type": "inline_richtext", "id": "title", "label": "Title" },
        
        { "type": "url", "id": "link_url", "label": "Link URL" },
        { "type": "text", "id": "link_label", "label": "Link label", "default": "Read more" },

        { "type": "image_picker", "id": "icon", "label": "Bottom right icon" },

        {
          "type": "select",
          "id": "ratio",
          "label": "Slide aspect ratio",
          "default": "1-1",
          "options": [
            { "label": "1:1 (square)", "value": "1-1" },
            { "label": "4:5 (tall)", "value": "4-5" },
            { "label": "3:4 (taller)", "value": "3-4" }
          ]
        },

        {
          "type": "color_scheme",
          "id": "color_scheme",
          "label": "Color scheme"
        }
      ]
    }
  ],
  "presets": [
    { "name": "RD Slider", "blocks": [{ "type": "slide" }, { "type": "slide" }, { "type": "slide" }] }
  ]
}
{% endschema %}
