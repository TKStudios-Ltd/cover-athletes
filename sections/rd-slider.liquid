{% comment %}
RD Slider â€” uses block color scheme + correct ratios (1:1 default, optional 3:2)
{% endcomment %}

<section
  class="rd-slider rd-slider-{{ section.id }}"
  data-section-id="{{ section.id }}"
  data-autoplay="{{ section.settings.autoplay }}"
  data-delay="{{ section.settings.delay }}"
>
  <div class="rd-slider__inner" style="
    --pad-top: {{ section.settings.padding_top }}px;
    --pad-bottom: {{ section.settings.padding_bottom }}px;
  ">

    <div class="swiper rd-swiper" id="RDSlider-{{ section.id }}">
      <div class="swiper-wrapper">

        {% for block in section.blocks %}
        <div class="swiper-slide rd-slide color-{{ block.settings.color_scheme }} ratio-{{ block.settings.ratio }}" {{ block.shopify_attributes }}>

            <div class="rd-slide__media" style="background: rgb(var(--color-background));">
            {% if block.settings.image != blank %}
                {{ block.settings.image | image_url: width: 2000 | image_tag: loading: 'lazy' }}
            {% endif %}
            </div>

          <div class="rd-slide__content">
            {% if block.settings.title != blank %}
              <div class="rd-slide__title rte">{{ block.settings.title }}</div>
            {% endif %}

            {% if block.settings.link_label != blank and block.settings.link_url != blank %}
              <a href="{{ block.settings.link_url }}" class="rd-slide__link">{{ block.settings.link_label }}</a>
            {% endif %}
          </div>

          {% if block.settings.icon != blank %}
            <div class="rd-slide__icon">
              {{ block.settings.icon | image_url: width: 100 | image_tag }}
            </div>
          {% endif %}

        </div>
        {% endfor %}

      </div>
    </div>

  </div>
</section>

<style>
.rd-slider { width: 100%; }

.rd-slider__inner {
  padding-top: var(--pad-top);
  padding-bottom: var(--pad-bottom);
}

/* SWIPER */
.rd-swiper {
  cursor: url("{{ 'cursor-drag.svg' | asset_url }}") 20 20, grab;
}
.rd-swiper:active { cursor: grabbing; }

/* === SLIDES === */
.rd-slide {
  position: relative;
  overflow: hidden;
  border-radius: 18px;
  width: calc(33.333% - 20px); /* 3-across desktop */
}

@media (max-width: 749px) {
  .rd-slide { width: 80%; }
}

.rd-swiper .swiper-wrapper {
  display: flex;
}

.rd-swiper .swiper-slide {
  flex-shrink: 0;
}


/* === RATIOS === */
.rd-slide__media img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

/* Default ratio: 1:1 */
.rd-slide.ratio-square .rd-slide__media {
  aspect-ratio: 1 / 1;
}
/* Optional: 5:4 */
.rd-slide.ratio-54 .rd-slide__media {
  aspect-ratio: 5 / 4;
}
/* Optional: 4:5 */
.rd-slide.ratio-45 .rd-slide__media {
  aspect-ratio: 4 / 5;
}

.rd-slide__media img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}


/* === CONTENT === */
.rd-slide__content {
  position: absolute;
  inset: 0;
  padding: 24px;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  color: var(--color-foreground);
  z-index: 2;
}

.rd-slide__title {
  font-size: 26px;
  font-weight: 600;
  max-width: 70%;
}

.rd-slide__link {
  font-size: 14px;
  text-decoration: underline;
}

.rd-slide__icon {
    position: absolute;
    bottom: 24px;
    right: 24px;
    z-index: 3;
}
.rd-slide__icon img {
    width: 100%;
    height: 24px;
}

.rd-slide__media {
  position: relative;
  background: rgb(var(--color-background));
}

.rd-slide__media img {
  display: block;
  width: 100%;
  height: 100%;
  object-fit: cover;
}

</style>

{% schema %}
{
  "name": "RD Slider",
  "settings": [
    { "type": "range", "id": "padding_top", "min": 0, "max": 120, "step": 5, "label": "Padding top", "default": 60 },
    { "type": "range", "id": "padding_bottom", "min": 0, "max": 120, "step": 5, "label": "Padding bottom", "default": 60 },

    { "type": "checkbox", "id": "autoplay", "label": "Autoplay", "default": true },
    { "type": "range", "id": "delay", "min": 2, "max": 12, "step": 1, "label": "Autoplay delay (sec)", "default": 5 }
  ],

  "blocks": [
    {
      "type": "slide",
      "name": "Slide",
      "settings": [
        { "type": "color_scheme", "id": "color_scheme", "label": "Color scheme" },
        { "type": "image_picker", "id": "image", "label": "Background image" },
        { "type": "inline_richtext", "id": "title", "label": "Title" },
        { "type": "text", "id": "link_label", "label": "Link label" },
        { "type": "url", "id": "link_url", "label": "Link URL" },
        { "type": "image_picker", "id": "icon", "label": "Bottom-right icon" },

        {
          "type": "select",
          "id": "ratio",
          "label": "Slide ratio",
          "default": "square",
          "options": [
            { "value": "square", "label": "Square (1:1)" },
            { "value": "54", "label": "Short (5:4)" },
            { "value": "45", "label": "Tall (4:5)" }
          ]
        }
      ]
    }
  ],

  "presets": [
    { "name": "RD Slider", "blocks": [{ "type": "slide" }, { "type": "slide" }, { "type": "slide" }] }
  ]
}
{% endschema %}
