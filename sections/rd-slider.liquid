{% comment %}
RD Slider
Blocks:
- image (bg)
- title (richtext)
- link
- icon
- ratio (1:1 or tall)
{% endcomment %}

<section
  class="rd-slider rd-slider-{{ section.id }} section-{{ section.id }}"
  data-section-id="{{ section.id }}"
>
  <div class="rd-slider__inner">

    <div class="swiper rd-swiper" id="RDSlider-{{ section.id }}">
      <div class="swiper-wrapper">

        {% for block in section.blocks %}
        {% assign ratio = block.settings.ratio %}
        <div class="swiper-slide rd-slide ratio-{{ ratio }}" {{ block.shopify_attributes }}>

          <div class="rd-slide__media">
            {% if block.settings.image != blank %}
              {{ block.settings.image | image_url: width: 2000 | image_tag: loading: 'lazy' }}
            {% endif %}
          </div>

          <div class="rd-slide__content">
            {% if block.settings.title != blank %}
              <div class="rd-slide__title rte">{{ block.settings.title }}</div>
            {% endif %}

            {% if block.settings.link_label != blank and block.settings.link_url != blank %}
              <a href="{{ block.settings.link_url }}" class="rd-slide__link">{{ block.settings.link_label }}</a>
            {% endif %}
          </div>

          {% if block.settings.icon != blank %}
            <div class="rd-slide__icon">
              {{ block.settings.icon | image_url: width: 100 | image_tag }}
            </div>
          {% endif %}

        </div>
        {% endfor %}

      </div>
    </div>

  </div>
</section>

<style>
.rd-slider { position: relative; width: 100%; }

.rd-slider__inner {
  padding: var(--section-padding-top, 60px) 0 var(--section-padding-bottom, 60px);
}

.rd-swiper {
  width: 100%;
  cursor: url("{{ 'cursor-drag.svg' | asset_url }}") 20 20, grab;
}

.rd-swiper:active {
  cursor: grabbing;
}

/* Layout */
.rd-slide {
  position: relative;
  overflow: hidden;
  border-radius: 18px;
  height: auto;
}

/* Equal-width multi-slide layout */
.rd-slide {
  width: calc(33.333% - 20px);
}

@media (max-width: 749px) {
  .rd-slide {
    width: 80%;
  }
}

/* Ratio logic */
.rd-slide.ratio-square .rd-slide__media img { aspect-ratio: 1/1; object-fit: cover; width: 100%; }
.rd-slide.ratio-tall   .rd-slide__media img { aspect-ratio: 4/5; object-fit: cover; width: 100%; }

/* Content positioning */
.rd-slide__content {
  position: absolute;
  inset: 0;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  padding: 24px;
  z-index: 2;
  color: #fff;
}

.rd-slide__title { font-size: 24px; font-weight: 600; max-width: 70%; }
.rd-slide__link { font-size: 14px; text-decoration: underline; margin-top: auto; }

.rd-slide__icon {
  position: absolute;
  bottom: 24px;
  right: 24px;
  z-index: 3;
  width: 40px;
  height: auto;
}

/* Media overlay gradient */
.rd-slide__media::after {
  content: "";
  position: absolute;
  inset: 0;
  background: linear-gradient(180deg, rgba(0,0,0,0.0) 20%, rgba(0,0,0,0.65) 100%);
  z-index: 1;
}
.rd-slide__media img { width: 100%; height: 100%; object-fit: cover; display: block; }
</style>

{% schema %}
{
  "name": "RD Slider",
  "settings": [
    {
      "type": "range",
      "id": "padding_top",
      "min": 0, "max": 120, "step": 4,
      "label": "Padding top",
      "default": 60
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0, "max": 120, "step": 4,
      "label": "Padding bottom",
      "default": 60
    },
    {
      "type": "checkbox",
      "id": "autoplay",
      "label": "Autoplay",
      "default": true
    },
    {
      "type": "range",
      "id": "delay",
      "min": 2, "max": 12, "step": 1,
      "label": "Autoplay delay (seconds)",
      "default": 5
    }
  ],
  "blocks": [
    {
      "type": "slide",
      "name": "Slide",
      "settings": [
        { "type": "image_picker", "id": "image", "label": "Background image" },
        { "type": "inline_richtext", "id": "title", "label": "Title" },
        { "type": "text", "id": "link_label", "label": "Link label" },
        { "type": "url", "id": "link_url", "label": "Link URL" },
        { "type": "image_picker", "id": "icon", "label": "Bottom right icon" },
        {
          "type": "select",
          "id": "ratio",
          "label": "Slide ratio",
          "default": "square",
          "options": [
            { "label": "Square (1:1)", "value": "square" },
            { "label": "Tall", "value": "tall" }
          ]
        }
      ]
    }
  ],
  "presets": [
    { "name": "RD Slider", "blocks": [{ "type": "slide" }, { "type": "slide" }, { "type": "slide" }] }
  ]
}
{% endschema %}
